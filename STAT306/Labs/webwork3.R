## Webwork 3
# Q1

x=c(-0.063114, -0.03538, -0.005977, 0.046451, 0.010618, -0.089884, -0.009908, 0.012117, -0.095181, -0.185636, -0.077798, 0.007791, -0.08955, -0.116457, 0.081953, 0.089772, 0.051721, 0.000196, 0.071522, 0.033009, 0.0351, -0.01996, 0.055779, 0.017615, -0.037675, 0.028115, 0.057133, 0.014651, -0.085532, -0.055388, 0.066516, -0.048612, 0.083928, 0.036193, -0.002293, 0.063257, 0.022393, 0.031457, -0.001048, 0.028097, -0.013593, -0.018426, -0.021708, -0.058467, -0.074467, 0.102307, -0.005071, 0.008497)
y=c(-0.234109, -0.048583, 0.058609, 0.049796, 0.046368, -0.076407, 0.032827, 0.036089, -0.199657, -0.155791, -0.140452, 0.059898, -0.12738, -0.002834, 0.165306, 0.049286, 0.00457, 0.051103, 0.151155, 0.061391, -0.037471, -0.02392, 0.012338, 0.060661, -0.050292, 0.064614, 0.082403, 0.024322, -0.057339, -0.096556, 0.057357, -0.145833, 0.083095, 0.043409, 0.061772, -0.005954, 0.019888, 0.009007, -0.06201, 0.137172, -0.020263, -0.015598, 0.007578, -0.093852, 0.058509, 0.139445, 0.024195, -0.02692) 

model = lm(y~x)
model

t = qt(0.975, length(x) - 2)
t


xnext=c(0.04266, 0.039787, 0.030852, -0.007526, -0.064699, 0.038793, 0.012519, 0.019571, 0.023947, -0.019988)
newdata = data.frame(x=xnext)
predict(model, newdata, interval="predict")

ynext=c(0.085381, 0.025558, 0.044965, 0.010066, -0.087292, 0.030632, -0.036111, -0.025686, -0.091674, -0.046203)
interval = predict(model, newdata, interval="predict")

counter = 0
for (i in 1:length(ynext)) {
  if (ynext[i] > interval[i,2] && ynext[i] < interval[i,3]) {
    counter = counter + 1
  }
}
counter

# Q4
# x; height of father
# y; height of son 
# units of cm

x=c(166.1, 177.7, 169.4, 172.9, 169, 171.2, 176.5, 182.4, 181, 174.5, 172.6, 167.3, 172.9, 176.2, 164.1, 175.2, 169.7, 174.7, 174, 163.2, 173.2, 183.2, 168.4, 194.3, 178.3, 173.3, 167.9, 179.3, 166.2, 165.7, 159.1, 171, 165.8, 169.3, 165.3, 172.8, 167.9, 184.8, 169.5, 176.5, 164.1, 157.2, 172.6, 173.5, 167.6, 174.3, 154.3, 173.4, 171.2, 164.1, 173.5, 159.2, 173.5, 187.8, 159.5, 179.2, 173.5, 165.4, 169.8, 170.2, 175.9, 165, 163.2, 181.4, 170.9, 184.4, 180.1, 170.4, 160.6, 170.6, 158.2, 172.6, 167, 167.8, 160.9, 160.7, 179.6, 179.3, 160, 174.1, 169.4, 178.3, 183.9, 185.4, 169.1, 164.2, 179.2, 159, 169.8, 171.4, 166.5, 182.7, 170.7, 179, 170.4, 171, 180, 176, 183.4, 184.1, 178, 168.2, 191.3, 183.2, 187.1, 170.2, 179, 170, 185.4, 180.1, 171.6, 187.9, 172.8, 168.1, 167.8, 167.8, 173.9, 168.2, 182.2, 158.5, 171.1, 182.6, 173.4, 167.9, 163.4, 174.9, 182.4, 177.1, 174.2, 174.9, 167.3, 175.4, 169.9, 179.5, 183.6, 177.5, 172.2, 155, 171.9, 158.5, 161.6, 178.8, 159.9, 168.6, 185, 173.5, 176.4, 168.2, 169.8, 166.6, 171.6, 170.6, 178.6, 168.1, 172.5, 162.3, 164.6, 170.8, 170.8, 193.4, 174.5, 172.8, 178.6, 173.8, 183, 170.5, 166.2, 173.1, 173, 175.1, 186.1, 157.4, 176.6, 178.5, 167.5, 172.3, 172.7, 175.1, 174.6, 164.2) 
y=c(176.3, 174.3, 174, 170.4, 169.6, 174.3, 169.9, 190.1, 170.3, 177.1, 169.5, 174.6, 176.1, 181.4, 165, 181, 171.7, 179.3, 174.6, 163.6, 172.6, 177.7, 164.2, 192.1, 187, 169.3, 167.9, 178.3, 178.2, 177.3, 158.2, 173.3, 169.3, 182.9, 177.4, 172.4, 167.9, 182.6, 178.7, 174, 171.8, 168.5, 179.6, 181.3, 169.8, 178.6, 161.9, 177.3, 171.9, 165.7, 170, 174.5, 180.5, 187.7, 178.4, 166.9, 173.7, 173.9, 169, 175.2, 179.8, 169.6, 165.5, 193.7, 170.7, 175, 169.7, 174.7, 164.3, 175.9, 160.4, 167.4, 170.9, 182.5, 164.1, 171.8, 174.4, 178.7, 176, 174.3, 169, 172.3, 178.3, 177.7, 164.1, 175.4, 167.9, 172.1, 169.6, 162.9, 171.2, 176.5, 168.6, 180, 170.5, 178, 172.2, 182.8, 178.7, 179.6, 176.6, 173.2, 198, 175.7, 169.9, 176.7, 183.6, 182.3, 186, 178, 172.9, 184.1, 176.1, 175.8, 168.4, 172.4, 176.6, 169.2, 175.3, 179.8, 180, 179.8, 170.7, 167.7, 159.6, 178.8, 176.8, 173.8, 168.2, 168.9, 182.6, 166.7, 176.6, 169.8, 188.8, 186.1, 175.2, 162.8, 169.5, 171.6, 167.2, 178.1, 172.1, 175.9, 177.5, 175.6, 181.9, 183.8, 178.8, 174.6, 172.1, 162.4, 174, 164.6, 172.1, 163.6, 172.8, 173.2, 168.2, 190.3, 184.4, 172.6, 182.5, 173.8, 182.6, 177.5, 176.2, 182.6, 175.8, 180.5, 177.1, 171.8, 174.9, 183.5, 168.7, 168.2, 156.8, 178.4, 168, 160) 

xbar = mean(x)
ybar = mean(y)
s_x = sd(x)
s_y = sd(y)
r_xy = cor(x,y)

xbar
ybar
s_x
s_y
r_xy

model <- lm(y~x)
model

x_new = 177
new_data = data.frame(x=c(177))

z <- predict(model, new_data, se.fit=TRUE)
z

abs(qt(0.05/2, 178))

predict(model, new_data, interval='confidence', level=0.95)

subset_of_sons <- y[x >= 177-2.5 & x<= 177+2.5]
n_subset <- length(subset_of_sons)
mean_subset <- mean(subset_of_sons)
sd_subset <- sd(subset_of_sons)

margin_of_error <- 2 * sd_subset / sqrt(n_subset)

lower_endpoint <- mean_subset - margin_of_error
upper_endpoint <- mean_subset + margin_of_error
lower_endpoint
upper_endpoint